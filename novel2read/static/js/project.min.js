!function(){let t=(window.innerWidth,"auto"),e=window.innerWidth>2e3?280:550;new Swiper(".swiper-container",{pagination:".swiper-pagination",effect:"coverflow",centeredSlides:!0,loop:!0,slidesPerView:t,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",coverflow:{rotate:0,stretch:0,depth:e,modifier:1,slideShadows:!1},slideToClickedSlide:!0});function o(t="",e="info"){document.body;let o=document.getElementsByClassName("container")[1],i=document.createElement("div");i.className=`alert alert-${e}`,i.textContent=t,o.appendChild(i),setTimeout(()=>{i.classList.add("animate")},100),setTimeout(()=>{i.classList.remove("animate")},1800),setTimeout(()=>{o.removeChild(i)},2e3)}$(".js-filter-form").change(function(){$(".js-filter-form").submit()});let i,r=$("[name=csrfmiddlewaretoken]").val(),a=r||function(t){var e=null;if(document.cookie&&""!==document.cookie)for(var o=document.cookie.split(";"),i=0;i<o.length;i++){var r=jQuery.trim(o[i]);if(r.substring(0,t.length+1)===t+"="){e=decodeURIComponent(r.substring(t.length+1));break}}return e}("csrftoken");function n(t){let e={lib_in:t.attr("data-lib-in")};$.ajax({url:t.attr("data-lib-url"),type:"post",dataType:"json",data:e,success:function(e){e.is_valid?e.in_lib?(t[0].hasAttribute("data-bookmark")?(t.html('<i class="far fa-bookmark"></i>'),o("Book removed from Library.")):t[0].hasAttribute("data-lib-remonly")?t.parents()[2].remove():t.html("Add to Library"),t.attr("data-lib-in",0)):(t[0].hasAttribute("data-bookmark")?(t.html('<i class="fas fa-bookmark"></i>'),o("Book added to Library.")):t.html('<i class="fas fa-check"></i> In Library'),t.attr("data-lib-in",1)):o(e.info_msg,"warning")},error:function(t,e,i){o(`${t.status} ${t.statusText}`,"error")}})}$.ajaxSetup({beforeSend:function(t,e){var o;o=e.type,/^(GET|HEAD|OPTIONS|TRACE)$/.test(o)||this.crossDomain||t.setRequestHeader("X-CSRFToken",a)}}),$(".js-vote-btn").click(function(){!function(t){$.ajax({url:t.attr("data-vote-url"),type:"post",dataType:"json",success:function(e){e.is_valid?(t.parent().parent().find(".js-bvotes").html(e.book_votes),$(".js-uvotes").html(e.user_votes)):o(e.info_msg,"warning")},error:function(t,e,i){o(`${t.status} ${t.statusText}`,"error")}})}($(this))}),$(".js-lib-btn").click(function(){let t=$(this);if(t[0].hasAttribute("data-lib-remonly")){if(!confirm("Are you sure you want to remove this book?"))return!1;n(t)}n(t)}),$("#search-form").on("keyup keypress",function(t){if(13===(t.keyCode||t.which))return t.preventDefault(),!1}),$("#search-form").on("change paste keyup",function(t){t.preventDefault(),clearTimeout(i);let e=$(this);return $("#id_search_field").val()&&(i=setTimeout(function(){console.log("timeouting"),function(t){$.ajax({url:t.attr("action"),type:"post",dataType:"json",data:{search_field:$("#id_search_field").val()},success:function(t){$(".booksearch__formresult").html(t.html_search_form_result)},error:function(t,e,i){o(`${t.status} ${t.statusText}`,"error")}})}(e)},300)),!1})}();